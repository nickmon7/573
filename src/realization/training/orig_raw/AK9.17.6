But it had also become a flourishing offshore finance centre with 347 banks before the investigation .